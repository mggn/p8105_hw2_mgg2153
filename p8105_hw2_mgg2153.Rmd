---
title: "p8105_hw2_mgg2153"
author: "mggn"
date: "9/25/2020"
output: github_document
---

## Hello and welcome to the second homework

The first order of business is to load the tidyverse, which I did in a code chunk
but I am hiding the chunk from showing when the file it knit :-)
```{r setup, include=FALSE}
library(tidyverse)
```


### Problem 2: NYC transit data

```{r nyc_transit}
transit_df = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>%
  select(line, station_name, station_latitude, station_longitude, 
         route1:route11, entrance_type, entry, vending, ada) %>%
  mutate(
    entry = recode(entry, "YES" = "TRUE", "NO" = "FALSE")
  )

print(transit_df)
#I want to retain:  line, station, name, station latitude / longitude, routes served, 
#entry, vending, entrance type, and ADA compliance
  
```

#### About the NYC transit data

This data set is about New York City's subway system, particularly the subway 
exits and entrances. It is important to note that the dataset being described 
below is the original dataset but after some minor manipulation on my end. In the
code above, you can see that I:  
  -kept only certain variables using the retain function  
  -recoded the variable entry to have true/false values using mutate and recode  
  -changed the variable names so that they follow good style conventions (lower
  case, with underscores in place of spaces) using the clean_names function from
  the janitor library  

The dataset has **`r nrow(transit_df)`** observations and **`r ncol(transit_df)`** variables, 
which are: **`r names(transit_df)`**  

Using the code below, we can identify the number of distinct stations:
```{r}
transit_df %>%
  distinct(line, station_name)

```
Based off the output, we can see that there are **465** distinct stations.

To determine how many stations are ADA compliant, we can run the following code:

```{r}
transit_df %>%
  filter(ada == "TRUE")

```
And we can see that there are **468** stations that are ADA compliant.

Finally, we want to see what the proportion of station entrances/exits without
vending allow entrance, which we can find by running the following code:

```{r}
transit_df %>%
  filter (vending == "NO" & entry == "TRUE")
```
And we can see that **69** stations without vending allow entry (this is actually
really cool info to be exploring lol)


After running these commands, Jeff asks us:
#### are these data tidy?

To which I respond no! And Hadley Wickham would say "hell no"
One example of the lack of tidiness is that the routes, for example, are treated
as their own separate variables (ie, each route has its own column) when, to be
normalized, the routes should be collapsed into one variable. We can normalize/
"tidy" the data by using pivot_longer:

```{r route_pivot}

transit_df_tidy =
  transit_df %>%
  mutate(
    route8 = as.character(route8),
    route9 = as.character(route9),
    route10 = as.character(route10),
    route11 = as.character(route11)
    ) %>%
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route_name"
  )

print(transit_df_tidy)
```

And then finally, we can find the distinct stations for the A train, and of those,
how many are ADA compliant:

```{r}
transit_df_tidy %>%
  filter(route_name == "A") %>%
  distinct(line, route_name)
```


### Problem 3: FiveThirtyEight data

```{r 538_data}

pols_df = read_csv("./data/pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(mon,into = c("year", "month", "day")) %>%
  mutate(
    month = month.abb[as.factor(month)]
  ) %>%
  mutate(
    president <- ifelse(prez_gop == 1, "gop", "dem") #need to take into account that in 1974, gop is 2; can change 2 to 1?
  ) %>%
  select(-prez_gop, -prez_dem, -day)
  

snp_df = read_csv("./data/snp.csv") %>%
  janitor::clean_names() %>%
  separate(date,into = c("day", "month", "year")) %>%
  mutate(
    month = month.abb[as.factor(month)],
    year = as.factor(year)
  ) %>%
  relocate(year,month)

unemployment_df = read_csv("./data/unemployment.csv") %>%
  mutate(
    Year = as.factor(Year)
  ) %>%
  pivot_longer(
    Jan:Dec,
    names_to = "month",
    values_to = "pct_unemployed"
  ) %>%
  rename(
    year = Year
  ) %>% mutate (
    month = month.abb[as.factor(month)]
  )
 
composite_538 =
  left_join(pols_df, snp_df, by = c("month", "year"))
            
composite_again =
  left_join(composite_538, unemployment_df, by = c("month", "year"))
            

  
```
.
